# hanabi.js

hanabi.jsは、軽量で型安全な静的サイトジェネレーター（SSG）です。モダンなWeb開発の手法を取り入れながら、コンポーネントとデザインの再利用性を高めることを目指しています。

## hanabi.js ビルド方法

currently, hanabi.js is developed using node.js 23.
prepare develop environment with [nix](https://nixos.org/download/) on WSL2:

```shell
sh <(curl -L https://nixos.org/nix/install) --no-daemon
mkdir -p ~/.config/nix && echo "experimental-features = nix-command flakes" > ~/.config/nix/nix.conf
git clone https://github.com/osawa-naotaka/hanabijs.git
cd hanabijs
nix develop
```

for build bundle:

```shell
yarn install
yarn build
```

develop test site:
```shell
yarn install
yarn dev
```

deploy test site:
```shell
yarn install
yarn site
```

## コンセプト

hanabi.jsは以下のコンセプトに基づいて設計されています：

### テーマの切り替えが可能なアーキテクチャ

WordPressのように、テーマを後から切り替え可能なアーキテクチャを採用しています。コンテンツ、構造、スタイルを論理的に分離することで、デザインの変更をコンテンツに影響を与えることなく行えます。

#### 構成要素の分離

- **コンテンツ（文章・画像）**: JSONで表現し、マークダウンもJSONに変換して操作します
- **スキーマ**: HTML要素を意味的に拡張したhanabiスキーマにより、コンテンツの構造を定義します
- **レイアウト**: 縦・横・グリッドなどの配置を指定します
- **装飾**: フォント・色・輪郭などの視覚的要素を定義します
- **アニメーション**: 動的な変化を定義します
- **スクリプト**: インタラクション要素を定義します

### 型安全なスタイリングシステム

CSS in JSをさらに進化させ、TypeScriptの型システムを最大限に活用したスタイリングシステムを構築しています。

- **関数ベースのスタイル定義**: CSSプロパティを関数として定義し、型チェックを活用
- **クラスセレクタの関数化**: 文字列ではなく関数でクラスセレクタを統一することで、タイプミスによるスタイル適用エラーを防止
- **コンポーネント単位のスタイル登録**: 各コンポーネントが自身のスタイルを登録し、使用されるコンポーネントのスタイルのみが出力される

### デザインシステムの階層化

デザイントークンからコンポーネントスタイルまで、一貫したデザインシステムを構築できます。

- **デザインルール**: 色、サイズ、スペーシングなどの基本要素を定義
- **スタイルの合成**: 基本スタイルを組み合わせて複雑なスタイルを構築
- **CSS変数の生成**: デザインルールから自動的にCSS変数を生成

### 関数型アプローチによるコンポーネント設計

関数型プログラミングのアプローチを活用し、コンポーネントの合成と再利用を促進します。

- **純粋関数としてのコンポーネント**: サイドエフェクトを最小限に抑えたコンポーネント設計
- **明示的な依存関係**: グローバル状態への依存を引数として明示
- **コンポーネントの合成**: 小さなコンポーネントから複雑なUIを構築

### リソース最適化

必要なリソースのみを含める最適化を自動的に行います。

- **フォントサブセット**: 使用されているアイコンやフォントのみを抽出してwoff2ファイルを生成
- **スタイルの最適化**: 未使用のスタイルを除外
- **アセット管理**: コンポーネントごとに必要なアセットを登録し、重複を排除

### 開発体験の向上

迅速な開発サイクルをサポートする仕組みを提供します。

- **開発サーバー**: 変更をリアルタイムで反映するホットリロード機能
- **タイプセーフ**: TypeScriptの型システムを活用した開発時の安全性
- **エラーハンドリング**: 明確なエラーメッセージとデバッグ情報

## 特徴

- **軽量**: 最小限の依存関係と最適化されたビルド
- **型安全**: TypeScriptを活用した堅牢な型システム
- **モジュラー**: 機能ごとに分離されたモジュール構造
- **拡張可能**: 柔軟なAPIによる機能拡張
- **パフォーマンス重視**: 効率的なビルドプロセスと最適化された出力

## 技術的な特徴

hanabi.jsは以下の技術的特徴を持っています：

1. **JSXサポート**: Reactライクな構文でコンポーネントを定義
2. **独自のコンポーネントシステム**: 仮想DOMを使用せず、直接HTMLを生成
3. **デザイントークンシステム**: デザイン変数を一元管理
4. **ツリーシェイキング**: 使用されるコードのみをバンドル
5. **ファイルベースのルーティング**: ディレクトリ構造に基づいたルーティング

## 設計思想

hanabi.jsは「表現と構造の分離」という原則に基づいています。これはHTMLを構造、CSSをスタイル、JavaScriptを挙動として分離するという従来のWeb開発の原則を拡張し、より柔軟な形でこれらを管理します。

コンポーネントごとにスタイル、挙動、構造を定義しながらも、これらを論理的に分離することで、テーマの切り替えやデザインシステムの変更を容易にしています。

また、関数型プログラミングの概念を取り入れ、副作用を最小限に抑えたコンポーネント設計を推奨しています。これにより、コードの予測可能性と再利用性が向上します。

## ロードマップ

- [ ] アニメーションシステムの強化
- [ ] インタラクティブコンポーネントライブラリの拡充
- [ ] ビルドパフォーマンスの最適化
- [ ] プラグインシステムの導入
- [ ] 国際化サポートの強化

## ライセンス

MIT
